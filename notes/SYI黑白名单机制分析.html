<!DOCTYPE html><html><head>
      <title>SYIé»‘ç™½åå•æœºåˆ¶åˆ†æ</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/ybeetle/.vscode-server/extensions/shd101wyy.markdown-preview-enhanced-0.8.19/crossnote/dependencies/katex/katex.min.css">
      
      
      <script type="text/javascript" src="file:////home/ybeetle/.vscode-server/extensions/shd101wyy.markdown-preview-enhanced-0.8.19/crossnote/dependencies/mermaid/mermaid.min.js" charset="UTF-8"></script>
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      <div>
<h1 id="syi-é»‘ç™½åå•æœºåˆ¶åˆ†æ">SYI é»‘ç™½åå•æœºåˆ¶åˆ†æ </h1>
<h2 id="-ç›®å½•">ğŸ“‹ ç›®å½• </h2>
<ul>
<li><a href="#%E4%B8%80%E9%BB%91%E7%99%BD%E5%90%8D%E5%8D%95%E7%B1%BB%E5%9E%8B%E6%80%BB%E8%A7%88">ä¸€ã€é»‘ç™½åå•ç±»å‹æ€»è§ˆ</a></li>
<li><a href="#%E4%BA%8C%E8%AF%A6%E7%BB%86%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90">äºŒã€è¯¦ç»†æœºåˆ¶åˆ†æ</a></li>
<li><a href="#%E4%B8%89%E6%B5%81%E7%A8%8B%E5%9B%BE">ä¸‰ã€æµç¨‹å›¾</a></li>
<li><a href="#%E5%9B%9B%E5%BD%B1%E5%93%8D%E8%8C%83%E5%9B%B4%E5%88%86%E6%9E%90">å››ã€å½±å“èŒƒå›´åˆ†æ</a></li>
<li><a href="#%E4%BA%94%E7%A7%BB%E9%99%A4%E9%BB%91%E7%99%BD%E5%90%8D%E5%8D%95%E7%9A%84%E5%BD%B1%E5%93%8D%E8%AF%84%E4%BC%B0">äº”ã€ç§»é™¤é»‘ç™½åå•çš„å½±å“è¯„ä¼°</a></li>
</ul>
<hr>
<h2 id="ä¸€-é»‘ç™½åå•ç±»å‹æ€»è§ˆ">ä¸€ã€é»‘ç™½åå•ç±»å‹æ€»è§ˆ </h2>
<h3 id="11-syi-ä»£å¸åˆçº¦syibasesol">1.1 SYI ä»£å¸åˆçº¦ï¼ˆSYIBase.solï¼‰ </h3>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>å˜é‡å</th>
<th>ä»£ç ä½ç½®</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>è´¹ç”¨ç™½åå•</strong></td>
<td><code>feeWhitelisted</code></td>
<td>Line 245</td>
<td>å…é™¤ä¹°å–äº¤æ˜“è´¹ç”¨</td>
</tr>
<tr>
<td><strong>äº¤æ˜“é»‘åå•</strong></td>
<td><code>blacklisted</code></td>
<td>Line 246</td>
<td>å®Œå…¨ç¦æ­¢ä¹°å–äº¤æ˜“</td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸç™½åå•</strong></td>
<td><code>feeWhitelisted</code> + <code>presaleActive</code></td>
<td>Line 245 + 233</td>
<td><strong>é¢„å”®æœŸé—´ä»…ç™½åå•å¯ä¹°å…¥</strong></td>
</tr>
</tbody>
</table>
<h3 id="12-staking-åˆçº¦stakingbasesol">1.2 Staking åˆçº¦ï¼ˆStakingBase.solï¼‰ </h3>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æœºåˆ¶åç§°</th>
<th>ä»£ç ä½ç½®</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>EOAæ£€æŸ¥</strong></td>
<td><code>onlyEOA</code> modifier</td>
<td>Line 161-165</td>
<td>ä»…å…è®¸å¤–éƒ¨è´¦æˆ·ï¼ˆéåˆçº¦ï¼‰è°ƒç”¨</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="äºŒ-è¯¦ç»†æœºåˆ¶åˆ†æ">äºŒã€è¯¦ç»†æœºåˆ¶åˆ†æ </h2>
<h3 id="21-è´¹ç”¨ç™½åå•feewhitelisted">2.1 è´¹ç”¨ç™½åå•ï¼ˆfeeWhitelistedï¼‰ </h3>
<h4 id="-å®šä¹‰">ğŸ“ å®šä¹‰ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-mapping">mapping</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token keyword keyword-public">public</span> feeWhitelisted<span class="token punctuation">;</span>  <span class="token comment">// Line 245</span>
</code></pre><h4 id="-åŠŸèƒ½">ğŸ¯ åŠŸèƒ½ </h4>
<p>å…é™¤ä»¥ä¸‹è´¹ç”¨ï¼š</p>
<ul>
<li><strong>ä¹°å…¥è´¹ç”¨</strong>: 1% burn + 2% LP = 3%</li>
<li><strong>å–å‡ºè´¹ç”¨</strong>: 1.5% marketing + 1.5% LP = 3%</li>
<li><strong>ç›ˆåˆ©ç¨</strong>: 25%</li>
<li><strong>LPæ“ä½œè´¹ç”¨</strong>: 2.5%</li>
<li><strong>å»¶è¿Ÿä¹°å…¥æœŸé™</strong>: ç»•è¿‡30å¤©é™åˆ¶</li>
</ul>
<h4 id="-ç®¡ç†å‡½æ•°">ğŸ”§ ç®¡ç†å‡½æ•° </h4>
<table>
<thead>
<tr>
<th>å‡½æ•°å</th>
<th>ä½ç½®</th>
<th>æƒé™</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>initializeWhitelist()</code></td>
<td>Line 318-329</td>
<td>Owner</td>
<td>ä¸€æ¬¡æ€§åˆå§‹åŒ–æ ¸å¿ƒåœ°å€</td>
</tr>
<tr>
<td><code>setFeeWhitelisted()</code></td>
<td>Line 361-366</td>
<td>Owner</td>
<td>å•ä¸ªåœ°å€è®¾ç½®</td>
</tr>
<tr>
<td><code>setBatchFeeWhitelisted()</code></td>
<td>Line 368-375</td>
<td>Owner</td>
<td>æ‰¹é‡åœ°å€è®¾ç½®</td>
</tr>
</tbody>
</table>
<h4 id="-åˆå§‹åŒ–åœ°å€initializewhitelist">ğŸ“¦ åˆå§‹åŒ–åœ°å€ï¼ˆinitializeWhitelistï¼‰ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code>feeWhitelisted<span class="token punctuation">[</span><span class="token function">owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>              <span class="token comment">// åˆçº¦æ‰€æœ‰è€…</span>
feeWhitelisted<span class="token punctuation">[</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token comment">// SYI åˆçº¦è‡ªèº«</span>
feeWhitelisted<span class="token punctuation">[</span><span class="token builtin">address</span><span class="token punctuation">(</span>staking<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>     <span class="token comment">// Staking åˆçº¦</span>
feeWhitelisted<span class="token punctuation">[</span>marketingAddress<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>     <span class="token comment">// è¥é”€åœ°å€</span>
feeWhitelisted<span class="token punctuation">[</span><span class="token builtin">address</span><span class="token punctuation">(</span>uniswapV2Router<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// è·¯ç”±åˆçº¦</span>
</code></pre><h4 id="-è°ƒç”¨é“¾è·¯">ğŸ”„ è°ƒç”¨é“¾è·¯ </h4>
<div class="mermaid">graph TB
    A[ç”¨æˆ·è½¬è´¦/äº¤æ˜“] --&gt; B{_update å‡½æ•°}
    B --&gt; C{from/to æ˜¯ç™½åå•?}
    C --&gt;|æ˜¯| D[ç›´æ¥è½¬è´¦ super._update]
    C --&gt;|å¦| E{æ˜¯ä¹°å…¥?}
    E --&gt;|æ˜¯| F[_handleBuy]
    E --&gt;|å¦| G{æ˜¯å–å‡º?}
    G --&gt;|æ˜¯| H[_handleSell]
    G --&gt;|å¦| D

    F --&gt; I{æ£€æŸ¥ delayedBuyCheck}
    I --&gt; J{æ˜¯ç™½åå•?}
    J --&gt;|æ˜¯| K[ç»•è¿‡å»¶è¿ŸæœŸ]
    J --&gt;|å¦| L{å»¶è¿ŸæœŸæ»¡?}
    L --&gt;|å¦| M[revert DelayedBuyPeriodNotMet]
    L --&gt;|æ˜¯| K
    K --&gt; N[æ”¶å–ä¹°å…¥è´¹ç”¨]

    H --&gt; O[æ£€æŸ¥å†·å´æ—¶é—´]
    O --&gt; P[æ”¶å–å–å‡ºè´¹ç”¨]
</div><h4 id="-æ ¸å¿ƒä»£ç ç‰‡æ®µ">ğŸ’¡ æ ¸å¿ƒä»£ç ç‰‡æ®µ </h4>
<p><strong>1. ä¸»è½¬è´¦é€»è¾‘ï¼ˆLine 730-762ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_update</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint256</span> value<span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> override <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// æ—©æœŸç™½åå•æ£€æŸ¥</span>
    <span class="token builtin">bool</span> isWhitelisted <span class="token operator">=</span> feeWhitelisted<span class="token punctuation">[</span><span class="token keyword keyword-from">from</span><span class="token punctuation">]</span> <span class="token operator">||</span> feeWhitelisted<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>isWhitelisted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        super<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç›´æ¥è½¬è´¦ï¼Œæ— è´¹ç”¨</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>2. å»¶è¿Ÿä¹°å…¥æ£€æŸ¥ï¼ˆLine 266-277ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-modifier">modifier</span> <span class="token function">delayedBuyCheck</span><span class="token punctuation">(</span><span class="token builtin">address</span> buyer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>delayedBuyEnabled <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>feeWhitelisted<span class="token punctuation">[</span>buyer<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// ç™½åå•ç»•è¿‡</span>
        <span class="token builtin">uint256</span> requiredDelay <span class="token operator">=</span> <span class="token function">getDelayedBuyPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 30å¤©</span>
        <span class="token builtin">uint256</span> baseTime <span class="token operator">=</span> delayedBuyEnabledTime <span class="token operator">&gt;</span> <span class="token number">0</span>
            <span class="token operator">?</span> delayedBuyEnabledTime
            <span class="token punctuation">:</span> contractDeployTime<span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> baseTime <span class="token operator">+</span> requiredDelay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-revert">revert</span> <span class="token function">DelayedBuyPeriodNotMet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-_">_</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><hr>
<h3 id="22-äº¤æ˜“é»‘åå•blacklisted">2.2 äº¤æ˜“é»‘åå•ï¼ˆblacklistedï¼‰ </h3>
<h4 id="-å®šä¹‰-1">ğŸ“ å®šä¹‰ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-mapping">mapping</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token keyword keyword-public">public</span> blacklisted<span class="token punctuation">;</span>  <span class="token comment">// Line 246</span>
</code></pre><h4 id="-åŠŸèƒ½-1">ğŸ¯ åŠŸèƒ½ </h4>
<p>å®Œå…¨ç¦æ­¢åœ°å€å‚ä¸ï¼š</p>
<ul>
<li>ä¹°å…¥äº¤æ˜“</li>
<li>å–å‡ºäº¤æ˜“</li>
<li>ä»»ä½•æ¶‰åŠä»£å¸è½¬ç§»çš„æ“ä½œ</li>
</ul>
<h4 id="-ç®¡ç†å‡½æ•°-1">ğŸ”§ ç®¡ç†å‡½æ•° </h4>
<table>
<thead>
<tr>
<th>å‡½æ•°å</th>
<th>ä½ç½®</th>
<th>æƒé™</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>setBlacklisted()</code></td>
<td>Line 386-391</td>
<td>Owner</td>
<td>å•ä¸ªåœ°å€è®¾ç½®</td>
</tr>
<tr>
<td><code>setBatchBlacklisted()</code></td>
<td>Line 377-384</td>
<td>Owner</td>
<td>æ‰¹é‡åœ°å€è®¾ç½®</td>
</tr>
</tbody>
</table>
<h4 id="-æ‹¦æˆªæœºåˆ¶">ğŸš« æ‹¦æˆªæœºåˆ¶ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-modifier">modifier</span> <span class="token function">notBlacklisted</span><span class="token punctuation">(</span><span class="token builtin">address</span> account<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Line 255-258</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>blacklisted<span class="token punctuation">[</span>account<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword keyword-revert">revert</span> <span class="token function">Blacklisted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-_">_</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="-è°ƒç”¨é“¾è·¯-1">ğŸ”„ è°ƒç”¨é“¾è·¯ </h4>
<div class="mermaid">graph TB
    A[äº¤æ˜“å‘èµ·] --&gt; B{æ˜¯ä¹°å…¥?}
    B --&gt;|æ˜¯| C[_handleBuy è°ƒç”¨]
    C --&gt; D[notBlacklisted to æ£€æŸ¥]
    D --&gt;|é»‘åå•| E[revert Blacklisted]
    D --&gt;|é€šè¿‡| F[æ‰§è¡Œä¹°å…¥]

    B --&gt;|æ˜¯å–å‡º| G[_handleSell è°ƒç”¨]
    G --&gt; H[notBlacklisted from æ£€æŸ¥]
    H --&gt;|é»‘åå•| E
    H --&gt;|é€šè¿‡| I[æ‰§è¡Œå–å‡º]
</div><h4 id="-æ ¸å¿ƒä»£ç ç‰‡æ®µ-1">ğŸ’¡ æ ¸å¿ƒä»£ç ç‰‡æ®µ </h4>
<p><strong>ä¹°å…¥æ£€æŸ¥ï¼ˆLine 817-848ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span>
    <span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amount
<span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token function">notBlacklisted</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span> <span class="token function">delayedBuyCheck</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// åŒæ—¶æ£€æŸ¥é»‘åå•å’Œå»¶è¿Ÿä¹°å…¥</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>å–å‡ºæ£€æŸ¥ï¼ˆLine 850-935ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_handleSell</span><span class="token punctuation">(</span>
    <span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amount
<span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token function">notBlacklisted</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// æ£€æŸ¥å–æ–¹é»‘åå•</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><hr>
<h3 id="23-eoa-æ£€æŸ¥æœºåˆ¶staking-åˆçº¦">2.3 EOA æ£€æŸ¥æœºåˆ¶ï¼ˆStaking åˆçº¦ï¼‰ </h3>
<h4 id="-å®šä¹‰-2">ğŸ“ å®šä¹‰ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-modifier">modifier</span> <span class="token function">onlyEOA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Line 161-165</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">shouldCheckEOA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> tx<span class="token punctuation">.</span>origin <span class="token operator">!=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span>
        <span class="token keyword keyword-revert">revert</span> <span class="token function">OnlyEOAAllowed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-_">_</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="-åŠŸèƒ½-2">ğŸ¯ åŠŸèƒ½ </h4>
<p>é˜²æ­¢æ™ºèƒ½åˆçº¦è°ƒç”¨å…³é”®å‡½æ•°ï¼š</p>
<ul>
<li><code>stake()</code> - è´¨æŠ¼</li>
<li><code>unstake()</code> - å–æ¶ˆè´¨æŠ¼</li>
</ul>
<h4 id="ï¸-ç¯å¢ƒé…ç½®">âš™ï¸ ç¯å¢ƒé…ç½® </h4>
<table>
<thead>
<tr>
<th>ç¯å¢ƒ</th>
<th>shouldCheckEOA()</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¸»ç½‘</td>
<td><code>true</code></td>
<td>å¯ç”¨EOAæ£€æŸ¥ï¼Œé˜²æ­¢åˆçº¦æ”»å‡»</td>
</tr>
<tr>
<td>æµ‹è¯•ç½‘</td>
<td><code>false</code></td>
<td>ç¦ç”¨EOAæ£€æŸ¥ï¼Œæ–¹ä¾¿æµ‹è¯•</td>
</tr>
</tbody>
</table>
<h4 id="-è°ƒç”¨é“¾è·¯-2">ğŸ”„ è°ƒç”¨é“¾è·¯ </h4>
<div class="mermaid">graph TB
    A[ç”¨æˆ·è°ƒç”¨ stake/unstake] --&gt; B{onlyEOA æ£€æŸ¥}
    B --&gt; C{shouldCheckEOA = true?}
    C --&gt;|å¦| D[å…è®¸æ‰§è¡Œ]
    C --&gt;|æ˜¯| E{tx.origin == msg.sender?}
    E --&gt;|æ˜¯ å¤–éƒ¨è´¦æˆ·| D
    E --&gt;|å¦ åˆçº¦è°ƒç”¨| F[revert OnlyEOAAllowed]
</div><h4 id="-æ ¸å¿ƒä»£ç ç‰‡æ®µ-2">ğŸ’¡ æ ¸å¿ƒä»£ç ç‰‡æ®µ </h4>
<p><strong>è´¨æŠ¼å‡½æ•°ï¼ˆLine 193-198ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">stake</span><span class="token punctuation">(</span><span class="token builtin">uint160</span> _amount<span class="token punctuation">,</span> <span class="token builtin">uint8</span> _stakeIndex<span class="token punctuation">)</span> <span class="token keyword keyword-external">external</span> onlyEOA <span class="token punctuation">{</span>
    <span class="token function">_validateStakeParameters</span><span class="token punctuation">(</span>_amount<span class="token punctuation">,</span> _stakeIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_swapAndAddLiquidity</span><span class="token punctuation">(</span>_amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">address</span> user <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token function">_mintStakeRecord</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> _amount<span class="token punctuation">,</span> _stakeIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>é…ç½®ï¼ˆStaking.sol Line 90-92ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">shouldCheckEOA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-pure">pure</span> override <span class="token keyword keyword-returns">returns</span> <span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸»ç½‘å¯ç”¨</span>
<span class="token punctuation">}</span>
</code></pre><hr>
<h3 id="24-é¢„å”®æœŸç™½åå•æœºåˆ¶-">2.4 é¢„å”®æœŸç™½åå•æœºåˆ¶ ğŸ”¥ğŸ”¥ğŸ”¥ </h3>
<blockquote>
<p><strong>âš ï¸ é‡ç‚¹è­¦å‘Š</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª<strong>éšè—çš„ç™½åå•é¢„å”®æœºåˆ¶</strong>ï¼Œä¸OKäº¤æ˜“æ‰€å®¡è®¡è¦æ±‚<strong>ä¸¥é‡å†²çª</strong>ï¼</p>
</blockquote>
<h4 id="-å®šä¹‰-3">ğŸ“ å®šä¹‰ </h4>
<p>é¢„å”®æœŸç™½åå•æ˜¯é€šè¿‡<strong>ç»„åˆä¸¤ä¸ªæœºåˆ¶</strong>å®ç°çš„ï¼š</p>
<table>
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>ä½ç½®</th>
<th>å˜é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç™½åå•æ£€æŸ¥</td>
<td><code>SYIBase.sol:743</code></td>
<td><code>feeWhitelisted[from] || feeWhitelisted[to]</code></td>
</tr>
<tr>
<td>é¢„å”®æœŸæ£€æŸ¥</td>
<td><code>SYIBase.sol:822-827</code></td>
<td><code>presaleActive &amp;&amp; block.timestamp &lt; presaleStartTime + presaleDuration</code></td>
</tr>
</tbody>
</table>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// é¢„å”®æœŸçŠ¶æ€å˜é‡</span>
<span class="token builtin">uint256</span> <span class="token keyword keyword-public">public</span> presaleStartTime<span class="token punctuation">;</span>      <span class="token comment">// Line 231</span>
<span class="token builtin">uint256</span> <span class="token keyword keyword-public">public</span> presaleDuration<span class="token punctuation">;</span>       <span class="token comment">// Line 232</span>
<span class="token builtin">bool</span> <span class="token keyword keyword-public">public</span> presaleActive<span class="token punctuation">;</span>            <span class="token comment">// Line 233</span>
</code></pre><h4 id="-å·¥ä½œåŸç†éšå¼ç™½åå•">ğŸ¯ å·¥ä½œåŸç†ï¼ˆéšå¼ç™½åå•ï¼‰ </h4>
<pre data-role="codeBlock" data-info="" class="language-text"><code>é¢„å”®æœŸé—´ï¼ˆpresaleActive = trueï¼Œ30å¤©å†…ï¼‰ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç™½åå•ç”¨æˆ·ä¹°å…¥  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â†’ _update() Line 730
        â”‚
        â”œâ”€â”€â†’ æ£€æŸ¥: feeWhitelisted[to] = true  âœ…
        â”‚
        â””â”€â”€â†’ ç›´æ¥æ‰§è¡Œ super._update()ï¼ˆLine 747-749ï¼‰
             ç»•è¿‡ _handleBuy()ï¼Œæ— é¢„å”®æœŸæ£€æŸ¥
             âœ… ä¹°å…¥æˆåŠŸ


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ™®é€šç”¨æˆ·ä¹°å…¥    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â†’ _update() Line 730
        â”‚
        â”œâ”€â”€â†’ æ£€æŸ¥: feeWhitelisted[to] = false
        â”‚
        â”œâ”€â”€â†’ è¿›å…¥ _handleBuy() Line 817
        â”‚
        â”œâ”€â”€â†’ é¢„å”®æœŸæ£€æŸ¥ Line 822-827:
        â”‚    if (presaleActive &amp;&amp; block.timestamp &lt; presaleStartTime + presaleDuration) {
        â”‚        revert NotAllowedBuy();  âŒ
        â”‚    }
        â”‚
        â””â”€â”€â†’ âŒ äº¤æ˜“å¤±è´¥ï¼Œrevert
</code></pre><h4 id="-æ ¸å¿ƒä»£ç ç‰‡æ®µ-3">ğŸ’¡ æ ¸å¿ƒä»£ç ç‰‡æ®µ </h4>
<p><strong>1. ç™½åå•ç»•è¿‡é¢„å”®æ£€æŸ¥ï¼ˆLine 743-749ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_update</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint256</span> value<span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> override <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token builtin">bool</span> isWhitelisted <span class="token operator">=</span> feeWhitelisted<span class="token punctuation">[</span><span class="token keyword keyword-from">from</span><span class="token punctuation">]</span> <span class="token operator">||</span> feeWhitelisted<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>isWhitelisted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        super<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ”¥ ç›´æ¥æ”¾è¡Œï¼Œç»•è¿‡æ‰€æœ‰æ£€æŸ¥</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>                           <span class="token comment">// åŒ…æ‹¬é¢„å”®æœŸæ£€æŸ¥ï¼</span>
    <span class="token punctuation">}</span>

    <span class="token builtin">bool</span> isBuy <span class="token operator">=</span> <span class="token function">_isBuyOperation</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">bool</span> isSell <span class="token operator">=</span> <span class="token function">_isSellOperation</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>isBuy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ™®é€šç”¨æˆ·è¿›å…¥è¿™é‡Œ</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>2. é¢„å”®æœŸä¹°å…¥æ‹¦æˆªï¼ˆLine 817-827ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span>
    <span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amount
<span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token function">notBlacklisted</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span> <span class="token function">delayedBuyCheck</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ğŸ”¥ é¢„å”®æœŸæ£€æŸ¥ï¼šæ™®é€šç”¨æˆ·ä¼šåœ¨è¿™é‡Œè¢«æ‹¦æˆª</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>
        presaleActive <span class="token operator">&amp;&amp;</span>
        block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> presaleStartTime <span class="token operator">+</span> presaleDuration
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-revert">revert</span> <span class="token function">NotAllowedBuy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âŒ æ™®é€šç”¨æˆ·æ— æ³•ä¹°å…¥</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åªæœ‰é¢„å”®æœŸç»“æŸåï¼Œæ™®é€šç”¨æˆ·æ‰èƒ½æ‰§è¡Œåˆ°è¿™é‡Œ</span>
    <span class="token comment">// ...ä¹°å…¥é€»è¾‘</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>3. é¢„å”®æœŸç®¡ç†ï¼ˆLine 409-417ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">setPresaleActive</span><span class="token punctuation">(</span><span class="token builtin">bool</span> _active<span class="token punctuation">)</span> <span class="token keyword keyword-external">external</span> onlyOwner <span class="token punctuation">{</span>
    presaleActive <span class="token operator">=</span> _active<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>_active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        presaleStartTime <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
        presaleDuration <span class="token operator">=</span> <span class="token function">getPresaleDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸»ç½‘30å¤©</span>
        <span class="token keyword keyword-emit">emit</span> <span class="token function">PresaleDurationUpdated</span><span class="token punctuation">(</span>presaleDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-emit">emit</span> <span class="token function">PresaleStatusUpdated</span><span class="token punctuation">(</span>_active<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>4. é¢„å”®æœŸé…ç½®ï¼ˆSYI.sol Line 32-34ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">getPresaleDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-pure">pure</span> override <span class="token keyword keyword-returns">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token number">30</span> days<span class="token punctuation">;</span>  <span class="token comment">// ğŸ”¥ ä¸»ç½‘30å¤©é¢„å”®æœŸ</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="-é¢„å”®æœŸå®Œæ•´æµç¨‹">ğŸ”„ é¢„å”®æœŸå®Œæ•´æµç¨‹ </h4>
<div class="mermaid">flowchart TD
    Start([ä»£å¸éƒ¨ç½²]) --&gt; Init[presaleActive = true&lt;br/&gt;presaleStartTime = now&lt;br/&gt;presaleDuration = 30 days]

    Init --&gt; Phase1[é˜¶æ®µ1: é¢„å”®æœŸ&lt;br/&gt;0-30å¤©]

    Phase1 --&gt; WhitelistUser[ç™½åå•ç”¨æˆ·å°è¯•ä¹°å…¥]
    Phase1 --&gt; NormalUser[æ™®é€šç”¨æˆ·å°è¯•ä¹°å…¥]

    WhitelistUser --&gt; CheckWhite{_update æ£€æŸ¥&lt;br/&gt;ç™½åå•?}
    CheckWhite --&gt;|æ˜¯| DirectPass[ç›´æ¥æ”¾è¡Œ&lt;br/&gt;super._update]
    DirectPass --&gt; Success1[âœ… ä¹°å…¥æˆåŠŸ&lt;br/&gt;æ— éœ€ç­‰å¾…]

    NormalUser --&gt; CheckWhite2{_update æ£€æŸ¥&lt;br/&gt;ç™½åå•?}
    CheckWhite2 --&gt;|å¦| HandleBuy[è¿›å…¥ _handleBuy]
    HandleBuy --&gt; PresaleCheck{é¢„å”®æœŸæ£€æŸ¥&lt;br/&gt;presaleActive?}
    PresaleCheck --&gt;|æ˜¯| RevertBuy[âŒ revert&lt;br/&gt;NotAllowedBuy]

    Phase1 --&gt; OwnerEnd[Owner è°ƒç”¨&lt;br/&gt;setPresaleActive false]
    OwnerEnd --&gt; Phase2[é˜¶æ®µ2: å…¬å¼€äº¤æ˜“æœŸ&lt;br/&gt;30å¤©å]

    Phase2 --&gt; PublicBuy[æ‰€æœ‰ç”¨æˆ·å°è¯•ä¹°å…¥]
    PublicBuy --&gt; HandleBuy2[è¿›å…¥ _handleBuy]
    HandleBuy2 --&gt; PresaleCheck2{é¢„å”®æœŸæ£€æŸ¥&lt;br/&gt;presaleActive?}
    PresaleCheck2 --&gt;|å¦| Success2[âœ… ä¹°å…¥æˆåŠŸ&lt;br/&gt;æ‰€æœ‰äººå¯äº¤æ˜“]

    style Phase1 fill:#FFE4E1
    style WhitelistUser fill:#90EE90
    style NormalUser fill:#FFB6C1
    style RevertBuy fill:#FF6B6B
    style Success1 fill:#98FB98
    style Success2 fill:#98FB98
    style PresaleCheck fill:#FFA500
</div><h4 id="ï¸-ä¸okäº¤æ˜“æ‰€å®¡è®¡çš„å†²çª">âš ï¸ ä¸OKäº¤æ˜“æ‰€å®¡è®¡çš„å†²çª </h4>
<table>
<thead>
<tr>
<th>å®¡è®¡ç»´åº¦</th>
<th>å½“å‰å®ç°</th>
<th>å®¡è®¡è¦æ±‚</th>
<th>å†²çªç¨‹åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç™½åå•é¢„å”®</strong></td>
<td>âœ… å­˜åœ¨</td>
<td>âŒ ä¸å…è®¸</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>åŠ¨æ€ç™½åå•</strong></td>
<td>âœ… å¯åŠ¨æ€æ·»åŠ /åˆ é™¤</td>
<td>âŒ ä¸å…è®¸</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>ä¹°å…¥é™åˆ¶</strong></td>
<td>âœ… é¢„å”®æœŸç¦æ­¢æ™®é€šç”¨æˆ·ä¹°å…¥</td>
<td>âŒ ä¸å…è®¸ä»»æ„é™åˆ¶</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>ç‰¹æƒåœ°å€</strong></td>
<td>âœ… ç™½åå•å…è´¹+ä¼˜å…ˆè´­ä¹°</td>
<td>âŒ æ‰€æœ‰ç”¨æˆ·å¹³ç­‰</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
</tbody>
</table>
<p><a href="http://xn--CLAUDE-hz8lt03a.md">æ ¹æ®CLAUDE.md</a>ï¼š</p>
<blockquote>
<p>è¦ä¸Šokäº¤æ˜“æ‰€,å¸ä»£ç ä¸Šåº”è¯¥ä¸å…è®¸æœ‰é»‘ç™½åå•, æœ‰è¿™åŠŸèƒ½ä¼šè¢«è‡ªåŠ¨æ ‡è®°ä¸ºè¯ˆéª—</p>
</blockquote>
<p><strong>é¢„å”®æœŸç™½åå•å±äºå…¸å‹çš„"é»‘ç™½åå•åŠŸèƒ½"ï¼Œå¿…é¡»ç§»é™¤ï¼</strong></p>
<h4 id="-å®é™…å½±å“æ¡ˆä¾‹">ğŸš¨ å®é™…å½±å“æ¡ˆä¾‹ </h4>
<p><strong>åœºæ™¯1ï¼šé¢„å”®æœŸå†…</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// 2024-01-01 00:00:00 åˆçº¦éƒ¨ç½²</span>
<span class="token comment">// presaleActive = true, presaleDuration = 30 days</span>

<span class="token comment">// 2024-01-15 (ç¬¬15å¤©)</span>
<span class="token comment">// ç™½åå•åœ°å€ 0xAAA ä¹°å…¥ 10,000 SYI</span>
<span class="token function">buyTokens</span><span class="token punctuation">(</span><span class="token number">0xAAA</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âœ… æˆåŠŸï¼Œæ— è´¹ç”¨</span>

<span class="token comment">// æ™®é€šç”¨æˆ· 0xBBB ä¹°å…¥ 10,000 SYI</span>
<span class="token function">buyTokens</span><span class="token punctuation">(</span><span class="token number">0xBBB</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âŒ revert: "NotAllowedBuy"</span>

<span class="token comment">// ç»“æœï¼šç™½åå•ç‹¬äº«é¢„å”®æœŸï¼Œæ™®é€šç”¨æˆ·æ— æ³•å‚ä¸</span>
</code></pre><p><strong>åœºæ™¯2ï¼šé¢„å”®ç»“æŸå</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// 2024-02-01 Owner å…³é—­é¢„å”®</span>
<span class="token function">setPresaleActive</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// presaleActive = false</span>

<span class="token comment">// æ™®é€šç”¨æˆ· 0xBBB å†æ¬¡å°è¯•ä¹°å…¥</span>
<span class="token function">buyTokens</span><span class="token punctuation">(</span><span class="token number">0xBBB</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âœ… æˆåŠŸï¼Œä½†éœ€æ”¯ä»˜3%è´¹ç”¨</span>

<span class="token comment">// ç™½åå•åœ°å€ 0xAAA ä¹°å…¥</span>
<span class="token function">buyTokens</span><span class="token punctuation">(</span><span class="token number">0xAAA</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âœ… æˆåŠŸï¼Œä¾ç„¶å…è´¹</span>

<span class="token comment">// ç»“æœï¼šç™½åå•æ°¸ä¹…äº«å—å…è´¹ä¼˜æƒ </span>
</code></pre><h4 id="-é¢„å”®æœŸç™½åå•å½±å“çŸ©é˜µ">ğŸ“Š é¢„å”®æœŸç™½åå•å½±å“çŸ©é˜µ </h4>
<table>
<thead>
<tr>
<th>æ—¶é—´æ®µ</th>
<th>ç™½åå•ç”¨æˆ·</th>
<th>æ™®é€šç”¨æˆ·</th>
<th>å·®å¼‚</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é¢„å”®æœŸï¼ˆ0-30å¤©ï¼‰</strong></td>
<td>âœ… å¯ä¹°å…¥ï¼Œå…è´¹</td>
<td>âŒ æ— æ³•ä¹°å…¥</td>
<td><strong>å®Œå…¨å°é”</strong></td>
</tr>
<tr>
<td><strong>å…¬å¼€æœŸï¼ˆ30å¤©åï¼‰</strong></td>
<td>âœ… å¯ä¹°å…¥ï¼Œå…è´¹</td>
<td>âœ… å¯ä¹°å…¥ï¼Œ3%è´¹ç”¨</td>
<td>3%è´¹ç”¨å·®è·</td>
</tr>
<tr>
<td><strong>å–å‡º</strong></td>
<td>âœ… å…è´¹</td>
<td>æ”¶3%+25%ç›ˆåˆ©ç¨</td>
<td>æœ€é«˜28%å·®è·</td>
</tr>
</tbody>
</table>
<h4 id="-æŸ¥è¯¢é¢„å”®çŠ¶æ€">ğŸ”§ æŸ¥è¯¢é¢„å”®çŠ¶æ€ </h4>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// æŸ¥è¯¢é¢„å”®çŠ¶æ€ï¼ˆLine 613-637ï¼‰</span>
<span class="token keyword keyword-function">function</span> <span class="token function">getPresaleStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-external">external</span> <span class="token keyword keyword-view">view</span>
    <span class="token keyword keyword-returns">returns</span> <span class="token punctuation">(</span>
        <span class="token builtin">bool</span> active<span class="token punctuation">,</span>           <span class="token comment">// é¢„å”®æ˜¯å¦æ¿€æ´»</span>
        <span class="token builtin">uint256</span> startTime<span class="token punctuation">,</span>     <span class="token comment">// é¢„å”®å¼€å§‹æ—¶é—´</span>
        <span class="token builtin">uint256</span> duration<span class="token punctuation">,</span>      <span class="token comment">// é¢„å”®æŒç»­æ—¶é—´</span>
        <span class="token builtin">uint256</span> remainingTime<span class="token punctuation">,</span> <span class="token comment">// å‰©ä½™æ—¶é—´</span>
        <span class="token builtin">bool</span> isInPresale       <span class="token comment">// å½“å‰æ˜¯å¦åœ¨é¢„å”®æœŸ</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token builtin">uint256</span> endTime <span class="token operator">=</span> presaleStartTime <span class="token operator">+</span> presaleDuration<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> remaining <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> endTime
        <span class="token operator">?</span> endTime <span class="token operator">-</span> block<span class="token punctuation">.</span>timestamp
        <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token builtin">bool</span> inPresale <span class="token operator">=</span> presaleActive <span class="token operator">&amp;&amp;</span> block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> endTime<span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>
        presaleActive<span class="token punctuation">,</span>
        presaleStartTime<span class="token punctuation">,</span>
        presaleDuration<span class="token punctuation">,</span>
        remaining<span class="token punctuation">,</span>
        inPresale
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="ï¸-ç§»é™¤æ–¹æ¡ˆ">ğŸ› ï¸ ç§»é™¤æ–¹æ¡ˆ </h4>
<p><strong>æ–¹æ¡ˆ1ï¼šå®Œå…¨ç§»é™¤é¢„å”®æœºåˆ¶ï¼ˆæ¨èï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// åˆ é™¤é¢„å”®ç›¸å…³å˜é‡</span>
<span class="token comment">// uint256 public presaleStartTime;</span>
<span class="token comment">// uint256 public presaleDuration;</span>
<span class="token comment">// bool public presaleActive;</span>

<span class="token comment">// åˆ é™¤ _handleBuy ä¸­çš„é¢„å”®æ£€æŸ¥</span>
<span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ é™¤ä»¥ä¸‹ä»£ç ï¼š</span>
    <span class="token comment">// if (presaleActive &amp;&amp; block.timestamp &lt; presaleStartTime + presaleDuration) {</span>
    <span class="token comment">//     revert NotAllowedBuy();</span>
    <span class="token comment">// }</span>

    <span class="token comment">// ç›´æ¥è¿›å…¥ä¹°å…¥é€»è¾‘</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>æ–¹æ¡ˆ2ï¼šæ”¹ä¸ºå¯¹æ‰€æœ‰äººçš„é”å®šæœŸï¼ˆä¸­ç«‹ï¼‰</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// æ”¹ä¸ºï¼šéƒ¨ç½²å30å¤©å†…ç¦æ­¢æ‰€æœ‰äººä¹°å…¥ï¼ˆåŒ…æ‹¬ç™½åå•ï¼‰</span>
<span class="token builtin">uint256</span> <span class="token keyword keyword-public">public</span> tradingStartTime<span class="token punctuation">;</span>  <span class="token comment">// äº¤æ˜“å¼€æ”¾æ—¶é—´</span>

<span class="token keyword keyword-function">function</span> <span class="token function">_update</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> override <span class="token punctuation">{</span>
    <span class="token comment">// åœ¨æœ€å¼€å§‹æ£€æŸ¥ï¼Œç™½åå•ä¹Ÿæ— æ³•ç»•è¿‡</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> tradingStartTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-revert">revert</span> <span class="token function">TradingNotStarted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...åç»­é€»è¾‘</span>
<span class="token punctuation">}</span>

<span class="token comment">// Ownerå¼€å¯äº¤æ˜“</span>
<span class="token keyword keyword-function">function</span> <span class="token function">startTrading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-external">external</span> onlyOwner <span class="token punctuation">{</span>
    tradingStartTime <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="ï¸-ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”">âš–ï¸ ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯” </h4>
<table>
<thead>
<tr>
<th>æ–¹æ¡ˆ</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
<th>å®¡è®¡åˆè§„æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ–¹æ¡ˆ1ï¼šå®Œå…¨ç§»é™¤</strong></td>
<td>å½»åº•å»é™¤ç™½åå•æœºåˆ¶<br>ä»£ç ç®€æ´</td>
<td>æ— æ³•æ§åˆ¶ä¸Šçº¿æ—¶æœº</td>
<td>âœ… å®Œå…¨åˆè§„</td>
</tr>
<tr>
<td><strong>æ–¹æ¡ˆ2ï¼šå…¨å±€é”å®š</strong></td>
<td>å¯æ§åˆ¶ä¸Šçº¿æ—¶é—´<br>å¯¹æ‰€æœ‰äººå…¬å¹³</td>
<td>éœ€è¦Owneræ‰‹åŠ¨å¼€å¯äº¤æ˜“</td>
<td>âš ï¸ éƒ¨åˆ†åˆè§„</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="ä¸‰-æµç¨‹å›¾">ä¸‰ã€æµç¨‹å›¾ </h2>
<h3 id="31-syi-ä»£å¸è½¬è´¦å®Œæ•´æµç¨‹">3.1 SYI ä»£å¸è½¬è´¦å®Œæ•´æµç¨‹ </h3>
<div class="mermaid">flowchart TD
    Start([ç”¨æˆ·å‘èµ·è½¬è´¦]) --&gt; CheckZero{from/to&lt;br/&gt;æ˜¯é›¶åœ°å€?}

    CheckZero --&gt;|æ˜¯| Mint[é“¸é€ /é”€æ¯&lt;br/&gt;super._update]
    CheckZero --&gt;|å¦| CheckWhitelist{from/to&lt;br/&gt;æ˜¯ç™½åå•?}

    CheckWhitelist --&gt;|æ˜¯| DirectTransfer[ç›´æ¥è½¬è´¦&lt;br/&gt;å…é™¤æ‰€æœ‰è´¹ç”¨&lt;br/&gt;super._update]
    CheckWhitelist --&gt;|å¦| CheckType{äº¤æ˜“ç±»å‹?}

    CheckType --&gt;|ä¹°å…¥| BuyFlow[ä¹°å…¥æµç¨‹&lt;br/&gt;_handleBuy]
    CheckType --&gt;|å–å‡º| SellFlow[å–å‡ºæµç¨‹&lt;br/&gt;_handleSell]
    CheckType --&gt;|æ™®é€šè½¬è´¦| DirectTransfer

    BuyFlow --&gt; BuyBlacklist{ä¹°æ–¹&lt;br/&gt;é»‘åå•?}
    BuyBlacklist --&gt;|æ˜¯| RevertBlack[âŒ revert&lt;br/&gt;Blacklisted]
    BuyBlacklist --&gt;|å¦| PresaleCheck{ğŸ”¥ é¢„å”®æœŸ&lt;br/&gt;æ£€æŸ¥}

    PresaleCheck --&gt; IsPresale{presaleActive&lt;br/&gt;= true?}
    IsPresale --&gt;|æ˜¯| RevertPresale[âŒ revert&lt;br/&gt;NotAllowedBuy&lt;br/&gt;ğŸ”¥ æ™®é€šç”¨æˆ·ç¦æ­¢ä¹°å…¥]
    IsPresale --&gt;|å¦| DelayCheck{å»¶è¿Ÿä¹°å…¥&lt;br/&gt;æ£€æŸ¥}

    DelayCheck --&gt; IsWhite{æ˜¯ç™½åå•?}
    IsWhite --&gt;|æ˜¯| BuyFee[æ”¶å–ä¹°å…¥è´¹ç”¨&lt;br/&gt;1% burn]
    IsWhite --&gt;|å¦| DelayEnabled{å»¶è¿Ÿå¯ç”¨?}
    DelayEnabled --&gt;|å¦| BuyFee
    DelayEnabled --&gt;|æ˜¯| TimeMet{æ»¡30å¤©?}
    TimeMet --&gt;|å¦| RevertDelay[âŒ revert&lt;br/&gt;DelayedBuyPeriodNotMet]
    TimeMet --&gt;|æ˜¯| BuyFee

    BuyFee --&gt; BuyComplete[ä¹°å…¥å®Œæˆ&lt;br/&gt;æ›´æ–°æŠ•èµ„è®°å½•]

    SellFlow --&gt; SellBlacklist{å–æ–¹&lt;br/&gt;é»‘åå•?}
    SellBlacklist --&gt;|æ˜¯| RevertBlack
    SellBlacklist --&gt;|å¦| ColdTime{å†·å´æ—¶é—´?}
    ColdTime --&gt;|æœªæ»¡| RevertCold[âŒ revert&lt;br/&gt;InColdPeriod]
    ColdTime --&gt;|å·²æ»¡| SellFee[æ”¶å–å–å‡ºè´¹ç”¨&lt;br/&gt;1.5% marketing&lt;br/&gt;+ ç›ˆåˆ©ç¨25%]

    SellFee --&gt; SellComplete[å–å‡ºå®Œæˆ&lt;br/&gt;æ›´æ–°æŠ•èµ„è®°å½•]

    BuyComplete --&gt; End([äº¤æ˜“å®Œæˆ])
    SellComplete --&gt; End
    DirectTransfer --&gt; End
    Mint --&gt; End

    style CheckWhitelist fill:#90EE90
    style BuyBlacklist fill:#FFB6C1
    style SellBlacklist fill:#FFB6C1
    style IsWhite fill:#87CEEB
    style PresaleCheck fill:#FFA500
    style IsPresale fill:#FFA500
    style RevertPresale fill:#FF6B6B
    style RevertBlack fill:#FF6B6B
    style RevertDelay fill:#FF6B6B
    style RevertCold fill:#FF6B6B
</div><h3 id="32-staking-è´¨æŠ¼æµç¨‹">3.2 Staking è´¨æŠ¼æµç¨‹ </h3>
<div class="mermaid">flowchart TD
    Start([ç”¨æˆ·è°ƒç”¨ stake]) --&gt; EOACheck{EOAæ£€æŸ¥}

    EOACheck --&gt; CheckEOA{shouldCheckEOA&lt;br/&gt;= true?}
    CheckEOA --&gt;|å¦ æµ‹è¯•ç½‘| ValidateParams[éªŒè¯å‚æ•°]
    CheckEOA --&gt;|æ˜¯ ä¸»ç½‘| TxOrigin{tx.origin ==&lt;br/&gt;msg.sender?}

    TxOrigin --&gt;|æ˜¯ å¤–éƒ¨è´¦æˆ·| ValidateParams
    TxOrigin --&gt;|å¦ åˆçº¦è°ƒç”¨| RevertEOA[âŒ revert&lt;br/&gt;OnlyEOAAllowed]

    ValidateParams --&gt; CheckAmount{é‡‘é¢æ£€æŸ¥}
    CheckAmount --&gt; CheckLimit{è¶…è¿‡é™é¢?}
    CheckLimit --&gt;|æ˜¯| RevertLimit[âŒ revert&lt;br/&gt;ExceedsMaxStakeAmount]
    CheckLimit --&gt;|å¦| CheckBind{ç»‘å®šæ¨èäºº?}

    CheckBind --&gt;|å¦| RevertBind[âŒ revert&lt;br/&gt;MustBindReferral]
    CheckBind --&gt;|æ˜¯| Swap[å…‘æ¢å¹¶æ·»åŠ æµåŠ¨æ€§]

    Swap --&gt; MintRecord[é“¸é€ è´¨æŠ¼è®°å½•&lt;br/&gt;mint sSYI]
    MintRecord --&gt; UpdateTeam[æ›´æ–°å›¢é˜ŸKPI]
    UpdateTeam --&gt; End([è´¨æŠ¼å®Œæˆ])

    style EOACheck fill:#87CEEB
    style CheckBind fill:#FFD700
    style RevertEOA fill:#FF6B6B
    style RevertLimit fill:#FF6B6B
    style RevertBind fill:#FF6B6B
</div><h3 id="33-é»‘ç™½åå•ç®¡ç†æµç¨‹">3.3 é»‘ç™½åå•ç®¡ç†æµç¨‹ </h3>
<div class="mermaid">flowchart TD
    Start([Owner ç®¡ç†é»‘ç™½åå•]) --&gt; ChooseAction{æ“ä½œç±»å‹}

    ChooseAction --&gt;|åˆå§‹åŒ–ç™½åå•| InitWhitelist[initializeWhitelist]
    ChooseAction --&gt;|å•ä¸ªåœ°å€| Single[å•ä¸ªåœ°å€æ“ä½œ]
    ChooseAction --&gt;|æ‰¹é‡åœ°å€| Batch[æ‰¹é‡åœ°å€æ“ä½œ]

    InitWhitelist --&gt; CheckInit{å·²åˆå§‹åŒ–?}
    CheckInit --&gt;|æ˜¯| RevertInit[âŒ revert&lt;br/&gt;AlreadyInitialized]
    CheckInit --&gt;|å¦| InitCore[åˆå§‹åŒ–æ ¸å¿ƒåœ°å€:&lt;br/&gt;Owner, SYI, Staking,&lt;br/&gt;Marketing, Router]

    Single --&gt; SingleType{ç™½åå•/é»‘åå•?}
    SingleType --&gt;|ç™½åå•| SetWhite[setFeeWhitelisted]
    SingleType --&gt;|é»‘åå•| SetBlack[setBlacklisted]

    Batch --&gt; BatchType{ç™½åå•/é»‘åå•?}
    BatchType --&gt;|ç™½åå•| BatchWhite[setBatchFeeWhitelisted]
    BatchType --&gt;|é»‘åå•| BatchBlack[setBatchBlacklisted]

    SetWhite --&gt; UpdateMapping1[æ›´æ–° mapping&lt;br/&gt;feeWhitelisted]
    SetBlack --&gt; UpdateMapping2[æ›´æ–° mapping&lt;br/&gt;blacklisted]
    BatchWhite --&gt; Loop1[å¾ªç¯è®¾ç½®å¤šä¸ªåœ°å€]
    BatchBlack --&gt; Loop2[å¾ªç¯è®¾ç½®å¤šä¸ªåœ°å€]

    InitCore --&gt; End([æ“ä½œå®Œæˆ])
    UpdateMapping1 --&gt; End
    UpdateMapping2 --&gt; End
    Loop1 --&gt; End
    Loop2 --&gt; End

    style InitWhitelist fill:#90EE90
    style SetWhite fill:#87CEEB
    style SetBlack fill:#FFB6C1
    style RevertInit fill:#FF6B6B
</div><hr>
<h2 id="å››-å½±å“èŒƒå›´åˆ†æ">å››ã€å½±å“èŒƒå›´åˆ†æ </h2>
<h3 id="41-è´¹ç”¨ç™½åå•å½±å“çŸ©é˜µ">4.1 è´¹ç”¨ç™½åå•å½±å“çŸ©é˜µ </h3>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ™®é€šç”¨æˆ·</th>
<th>ç™½åå•ç”¨æˆ·</th>
<th>å½±å“</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¹°å…¥äº¤æ˜“</td>
<td>æ”¶å–1% burnè´¹</td>
<td>âœ… å…è´¹</td>
<td>èŠ‚çœ3%</td>
</tr>
<tr>
<td>å–å‡ºäº¤æ˜“</td>
<td>æ”¶å–1.5% marketingè´¹</td>
<td>âœ… å…è´¹</td>
<td>èŠ‚çœ3%</td>
</tr>
<tr>
<td>ç›ˆåˆ©ç¨</td>
<td>æ”¶å–25%ç›ˆåˆ©ç¨</td>
<td>âœ… å…è´¹</td>
<td>èŠ‚çœ25%</td>
</tr>
<tr>
<td>å»¶è¿Ÿä¹°å…¥</td>
<td>ç­‰å¾…30å¤©</td>
<td>âœ… ç«‹å³ä¹°å…¥</td>
<td>æ— éœ€ç­‰å¾…</td>
</tr>
<tr>
<td>LPæ“ä½œ</td>
<td>æ”¶å–2.5%è´¹ç”¨</td>
<td>âœ… å…è´¹</td>
<td>èŠ‚çœ2.5%</td>
</tr>
<tr>
<td>æ™®é€šè½¬è´¦</td>
<td>å…è´¹</td>
<td>å…è´¹</td>
<td>æ— å·®å¼‚</td>
</tr>
</tbody>
</table>
<h3 id="42-é»‘åå•å½±å“çŸ©é˜µ">4.2 é»‘åå•å½±å“çŸ©é˜µ </h3>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ™®é€šç”¨æˆ·</th>
<th>é»‘åå•ç”¨æˆ·</th>
<th>å½±å“</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¹°å…¥äº¤æ˜“</td>
<td>âœ… å…è®¸</td>
<td>âŒ revert</td>
<td>å®Œå…¨ç¦æ­¢</td>
</tr>
<tr>
<td>å–å‡ºäº¤æ˜“</td>
<td>âœ… å…è®¸</td>
<td>âŒ revert</td>
<td>å®Œå…¨ç¦æ­¢</td>
</tr>
<tr>
<td>æŒæœ‰ä»£å¸</td>
<td>âœ… å…è®¸</td>
<td>âœ… å…è®¸</td>
<td>æ— å½±å“</td>
</tr>
<tr>
<td>æ™®é€šè½¬è´¦</td>
<td>âœ… å…è®¸</td>
<td>âœ… å…è®¸*</td>
<td>*å¦‚æœä¸æ¶‰åŠpair</td>
</tr>
<tr>
<td>è´¨æŠ¼/å–æ¬¾</td>
<td>âœ… å…è®¸</td>
<td>âœ… å…è®¸</td>
<td>æ— å½±å“</td>
</tr>
</tbody>
</table>
<h3 id="43-ä»£ç ä½ç½®ç´¢å¼•">4.3 ä»£ç ä½ç½®ç´¢å¼• </h3>
<table>
<thead>
<tr>
<th>æœºåˆ¶</th>
<th>ç›¸å…³ä»£ç ä½ç½®</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç™½åå•å®šä¹‰</td>
<td><code>SYIBase.sol:245</code></td>
<td><code>mapping(address =&gt; bool) public feeWhitelisted</code></td>
</tr>
<tr>
<td>é»‘åå•å®šä¹‰</td>
<td><code>SYIBase.sol:246</code></td>
<td><code>mapping(address =&gt; bool) public blacklisted</code></td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸçŠ¶æ€</strong></td>
<td><code>SYIBase.sol:231-233</code></td>
<td><code>presaleStartTime, presaleDuration, presaleActive</code></td>
</tr>
<tr>
<td>ç™½åå•åˆå§‹åŒ–</td>
<td><code>SYIBase.sol:318-329</code></td>
<td><code>initializeWhitelist()</code></td>
</tr>
<tr>
<td>é»‘åå•æ£€æŸ¥</td>
<td><code>SYIBase.sol:255-258</code></td>
<td><code>modifier notBlacklisted</code></td>
</tr>
<tr>
<td>å»¶è¿Ÿä¹°å…¥æ£€æŸ¥</td>
<td><code>SYIBase.sol:266-277</code></td>
<td><code>modifier delayedBuyCheck</code></td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸæ£€æŸ¥</strong></td>
<td><code>SYIBase.sol:822-827</code></td>
<td><code>if (presaleActive &amp;&amp; ...) revert NotAllowedBuy()</code></td>
</tr>
<tr>
<td>ä¸»è½¬è´¦é€»è¾‘</td>
<td><code>SYIBase.sol:730-762</code></td>
<td><code>_update()</code> - <strong>ç™½åå•ç»•è¿‡é¢„å”®æ£€æŸ¥</strong></td>
</tr>
<tr>
<td>ä¹°å…¥å¤„ç†</td>
<td><code>SYIBase.sol:817-848</code></td>
<td><code>_handleBuy()</code> - <strong>é¢„å”®æœŸæ‹¦æˆªæ™®é€šç”¨æˆ·</strong></td>
</tr>
<tr>
<td>å–å‡ºå¤„ç†</td>
<td><code>SYIBase.sol:850-935</code></td>
<td><code>_handleSell()</code></td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸç®¡ç†</strong></td>
<td><code>SYIBase.sol:409-417</code></td>
<td><code>setPresaleActive()</code></td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸæŸ¥è¯¢</strong></td>
<td><code>SYIBase.sol:613-637</code></td>
<td><code>getPresaleStatus()</code></td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸé…ç½®</strong></td>
<td><code>SYI.sol:32-34</code></td>
<td><code>getPresaleDuration() = 30 days</code></td>
</tr>
<tr>
<td>EOAæ£€æŸ¥</td>
<td><code>StakingBase.sol:161-165</code></td>
<td><code>modifier onlyEOA</code></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="äº”-ç§»é™¤é»‘ç™½åå•çš„å½±å“è¯„ä¼°">äº”ã€ç§»é™¤é»‘ç™½åå•çš„å½±å“è¯„ä¼° </h2>
<h3 id="51-ç§»é™¤ç™½åå•feewhitelistedçš„å½±å“">5.1 ç§»é™¤ç™½åå•ï¼ˆfeeWhitelistedï¼‰çš„å½±å“ </h3>
<h4 id="-è´Ÿé¢å½±å“">âŒ è´Ÿé¢å½±å“ </h4>
<table>
<thead>
<tr>
<th>å½±å“å¯¹è±¡</th>
<th>å…·ä½“å½±å“</th>
<th>ä¸¥é‡ç¨‹åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Staking åˆçº¦</strong></td>
<td>è´¨æŠ¼/å–æ¬¾æ—¶éœ€æ”¯ä»˜3%è´¹ç”¨ï¼ŒæŸè€—æœ¬é‡‘</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>SYI åˆçº¦è‡ªèº«</strong></td>
<td>è´¹ç”¨åˆ†å‘/æµåŠ¨æ€§æ“ä½œéœ€æ”¯ä»˜è´¹ç”¨ï¼Œé€ æˆæ­»å¾ªç¯</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>Router åˆçº¦</strong></td>
<td>è·¯ç”±æ“ä½œéœ€æ”¯ä»˜è´¹ç”¨ï¼Œå½±å“äº¤æ˜“æ•ˆç‡</td>
<td>ğŸŸ¡ ä¸­ç­‰</td>
</tr>
<tr>
<td><strong>Marketing åœ°å€</strong></td>
<td>æ”¶åˆ°è¥é”€è´¹ç”¨æ—¶éœ€æ”¯ä»˜3%è´¹ç”¨</td>
<td>ğŸŸ¡ ä¸­ç­‰</td>
</tr>
<tr>
<td><strong>Owner åœ°å€</strong></td>
<td>æ— æ³•å…è´¹ç®¡ç†ä»£å¸ï¼Œå¢åŠ è¿è¥æˆæœ¬</td>
<td>ğŸŸ¢ è½»å¾®</td>
</tr>
<tr>
<td><strong>å»¶è¿Ÿä¹°å…¥æœºåˆ¶</strong></td>
<td>æ‰€æœ‰ç”¨æˆ·éœ€ç­‰å¾…30å¤©æ‰èƒ½ä¹°å…¥</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
</tbody>
</table>
<h4 id="-æŠ€æœ¯é—®é¢˜">ğŸ”§ æŠ€æœ¯é—®é¢˜ </h4>
<ol>
<li><strong>è´¹ç”¨é€’å½’é—®é¢˜</strong></li>
</ol>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// å½“å‰é€»è¾‘ï¼ˆæœ‰ç™½åå•ï¼‰</span>
amountMarketingFee <span class="token operator">+=</span> marketingFee<span class="token punctuation">;</span>  <span class="token comment">// ç´¯ç§¯è´¹ç”¨</span>
<span class="token function">_swapTokensForUSDT</span><span class="token punctuation">(</span>amountMarketingFee<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// åˆçº¦swapï¼Œå…è´¹</span>
<span class="token function">IERC20</span><span class="token punctuation">(</span>USDT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>marketingAddress<span class="token punctuation">,</span> usdtAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å‘é€USDT</span>

<span class="token comment">// ç§»é™¤ç™½åå•å</span>
amountMarketingFee <span class="token operator">+=</span> marketingFee<span class="token punctuation">;</span>  <span class="token comment">// ç´¯ç§¯è´¹ç”¨</span>
<span class="token function">_swapTokensForUSDT</span><span class="token punctuation">(</span>amountMarketingFee<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ’¥ åˆçº¦swapï¼Œå†æ”¶3%è´¹ç”¨</span>
<span class="token function">IERC20</span><span class="token punctuation">(</span>USDT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>marketingAddress<span class="token punctuation">,</span> usdtAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ’¥ å†æ”¶3%è´¹ç”¨</span>
<span class="token comment">// ç»“æœï¼šè´¹ç”¨å åŠ ï¼Œç»æµæ¨¡å‹å´©æºƒ</span>
</code></pre><ol start="2">
<li><strong>Staking å¾ªç¯é—®é¢˜</strong></li>
</ol>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// è´¨æŠ¼æµç¨‹</span>
<span class="token function">IERC20</span><span class="token punctuation">(</span>USDT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> staking<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç”¨æˆ·è½¬USDTåˆ°Staking</span>
SYI<span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>pair<span class="token punctuation">,</span> user<span class="token punctuation">,</span> netAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ’¥ Pair -&gt; User éœ€æ”¶è´¹3%</span>

<span class="token comment">// å–æ¬¾æµç¨‹</span>
SYI<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>pair<span class="token punctuation">,</span> calculatedReward<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ’¥ Staking -&gt; Pair éœ€æ”¶è´¹3%</span>
USDT<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> finalAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Stakingå‘é€USDTï¼Œæ­£å¸¸</span>
<span class="token comment">// ç»“æœï¼šç”¨æˆ·æœ¬é‡‘æŸè€—6%</span>
</code></pre><ol start="3">
<li><strong>æµåŠ¨æ€§æ“ä½œé—®é¢˜</strong></li>
</ol>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// æ·»åŠ æµåŠ¨æ€§</span>
SYI<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>pair<span class="token punctuation">,</span> tokenAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸ’¥ éœ€æ”¶è´¹3%</span>
USDT<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>pair<span class="token punctuation">,</span> usdtAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç»“æœï¼šLPä»£å¸æ•°é‡é”™è¯¯ï¼Œä»·æ ¼æ‰­æ›²</span>
</code></pre><h4 id="-okäº¤æ˜“æ‰€åˆè§„è¦æ±‚">âœ… OKäº¤æ˜“æ‰€åˆè§„è¦æ±‚ </h4>
<p>æ ¹æ®CLAUDE.mdä¸­æåˆ°ï¼š</p>
<blockquote>
<p>è¦ä¸Šokäº¤æ˜“æ‰€,å¸ä»£ç ä¸Šåº”è¯¥ä¸å…è®¸æœ‰é»‘ç™½åå•, æœ‰è¿™åŠŸèƒ½ä¼šè¢«è‡ªåŠ¨æ ‡è®°ä¸ºè¯ˆéª—</p>
</blockquote>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>âŒ <strong>ä¸èƒ½ç®€å•ç§»é™¤</strong> - ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ</li>
<li>âœ… <strong>é‡æ„è´¹ç”¨é€»è¾‘</strong> - æ”¹ä¸º"æºåœ°å€/ç›®æ ‡åœ°å€"åˆ¤æ–­</li>
<li>âœ… <strong>ç¡¬ç¼–ç æ ¸å¿ƒåœ°å€</strong> - ç”¨ <code>if (from == address(staking))</code> æ›¿ä»£ç™½åå•</li>
</ul>
<h3 id="52-ç§»é™¤é»‘åå•blacklistedçš„å½±å“">5.2 ç§»é™¤é»‘åå•ï¼ˆblacklistedï¼‰çš„å½±å“ </h3>
<h4 id="-æ­£é¢å½±å“">âœ… æ­£é¢å½±å“ </h4>
<table>
<thead>
<tr>
<th>æ–¹é¢</th>
<th>å½±å“</th>
<th>å¥½å¤„</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>äº¤æ˜“æ‰€åˆè§„</strong></td>
<td>é€šè¿‡å®‰å…¨å®¡è®¡</td>
<td>é¿å…è¢«æ ‡è®°ä¸ºè¯ˆéª—é¡¹ç›®</td>
</tr>
<tr>
<td><strong>ç”¨æˆ·ä¿¡ä»»</strong></td>
<td>æå‡é€æ˜åº¦</td>
<td>æ— æ³•ä»»æ„å†»ç»“ç”¨æˆ·èµ„äº§</td>
</tr>
<tr>
<td><strong>å»ä¸­å¿ƒåŒ–</strong></td>
<td>ç¬¦åˆDeFiç²¾ç¥</td>
<td>æ— å®¡æŸ¥äº¤æ˜“</td>
</tr>
</tbody>
</table>
<h4 id="-è´Ÿé¢å½±å“-1">âŒ è´Ÿé¢å½±å“ </h4>
<table>
<thead>
<tr>
<th>é£é™©</th>
<th>å½±å“</th>
<th>ä¸¥é‡ç¨‹åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ— æ³•é˜»æ­¢é»‘å®¢</strong></td>
<td>è¢«ç›—èµ„é‡‘æ— æ³•å†»ç»“</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>æ— æ³•é˜²èŒƒå¥³å·«æ”»å‡»</strong></td>
<td>æ¶æ„åœ°å€æ— æ³•å°ç¦</td>
<td>ğŸŸ¡ ä¸­ç­‰</td>
</tr>
<tr>
<td><strong>ç›‘ç®¡åˆè§„</strong></td>
<td>æ— æ³•é…åˆæ‰§æ³•</td>
<td>ğŸŸ¡ ä¸­ç­‰</td>
</tr>
</tbody>
</table>
<h4 id="-æ›¿ä»£æ–¹æ¡ˆ">ğŸ”§ æ›¿ä»£æ–¹æ¡ˆ </h4>
<p>ç”±äºé»‘åå•åªåœ¨<strong>ä¹°å–äº¤æ˜“</strong>æ—¶æ£€æŸ¥ï¼Œç§»é™¤å½±å“è¾ƒå°ï¼š</p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// å½“å‰é€»è¾‘ï¼ˆæœ‰é»‘åå•ï¼‰</span>
<span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token function">notBlacklisted</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¹°å…¥é€»è¾‘</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç§»é™¤é»‘åå•å</span>
<span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¹°å…¥é€»è¾‘ - ä»»ä½•äººéƒ½å¯ä»¥ä¹°å…¥</span>
<span class="token punctuation">}</span>

<span class="token comment">// å½±å“ï¼šé»‘å®¢/æ¶æ„åœ°å€å¯ä»¥ä¹°å–ï¼Œä½†ä¸å½±å“ç³»ç»Ÿè¿è¡Œ</span>
</code></pre><h3 id="53-ç§»é™¤-eoa-æ£€æŸ¥çš„å½±å“">5.3 ç§»é™¤ EOA æ£€æŸ¥çš„å½±å“ </h3>
<h4 id="-è´Ÿé¢å½±å“-2">âŒ è´Ÿé¢å½±å“ </h4>
<table>
<thead>
<tr>
<th>é£é™©</th>
<th>å½±å“</th>
<th>ä¸¥é‡ç¨‹åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é—ªç”µè´·æ”»å‡»</strong></td>
<td>åˆ©ç”¨é—ªç”µè´·æ“çºµè´¨æŠ¼å¥–åŠ±</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>é‡å…¥æ”»å‡»</strong></td>
<td>æ¶æ„åˆçº¦é€’å½’è°ƒç”¨</td>
<td>ğŸ”´ ä¸¥é‡</td>
</tr>
<tr>
<td><strong>å¥—åˆ©æœºå™¨äºº</strong></td>
<td>è‡ªåŠ¨åŒ–å¥—åˆ©æŸå®³æ™®é€šç”¨æˆ·</td>
<td>ğŸŸ¡ ä¸­ç­‰</td>
</tr>
</tbody>
</table>
<h4 id="-æ›¿ä»£æ–¹æ¡ˆ-1">ğŸ”§ æ›¿ä»£æ–¹æ¡ˆ </h4>
<p>EOAæ£€æŸ¥æ˜¯<strong>å¯é€‰çš„</strong>ï¼Œé€šè¿‡é…ç½®æ§åˆ¶ï¼š</p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// ä¸»ç½‘ï¼šå¯ç”¨EOAæ£€æŸ¥</span>
<span class="token keyword keyword-function">function</span> <span class="token function">shouldCheckEOA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-pure">pure</span> override <span class="token keyword keyword-returns">returns</span> <span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¦‚æœéœ€è¦ç§»é™¤ï¼š</span>
<span class="token keyword keyword-function">function</span> <span class="token function">shouldCheckEOA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> <span class="token keyword keyword-pure">pure</span> override <span class="token keyword keyword-returns">returns</span> <span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// å…è®¸åˆçº¦è°ƒç”¨</span>
<span class="token punctuation">}</span>
</code></pre><hr>
<h2 id="å…­-æ¨èçš„å»é»‘ç™½åå•æ–¹æ¡ˆ">å…­ã€æ¨èçš„å»é»‘ç™½åå•æ–¹æ¡ˆ </h2>
<h3 id="61-æ–¹æ¡ˆaç¡¬ç¼–ç æ ¸å¿ƒåœ°å€æ¨è">6.1 æ–¹æ¡ˆAï¼šç¡¬ç¼–ç æ ¸å¿ƒåœ°å€ï¼ˆæ¨èï¼‰ </h3>
<h4 id="å®æ–½æ­¥éª¤">å®æ–½æ­¥éª¤ </h4>
<p><strong>æ­¥éª¤1ï¼šç§»é™¤ç™½åå•mapping</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// åˆ é™¤</span>
<span class="token comment">// mapping(address =&gt; bool) public feeWhitelisted;</span>

<span class="token comment">// æ·»åŠ ä¸å¯å˜åœ°å€</span>
<span class="token builtin">address</span> <span class="token keyword keyword-public">public</span> immutable STAKING_CONTRACT<span class="token punctuation">;</span>
<span class="token builtin">address</span> <span class="token keyword keyword-public">public</span> immutable MARKETING_ADDRESS<span class="token punctuation">;</span>
</code></pre><p><strong>æ­¥éª¤2ï¼šé‡å†™è´¹ç”¨æ£€æŸ¥é€»è¾‘</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-function">function</span> <span class="token function">_update</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint256</span> value<span class="token punctuation">)</span> <span class="token keyword keyword-internal">internal</span> override <span class="token punctuation">{</span>
    <span class="token comment">// é›¶åœ°å€æ£€æŸ¥</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-from">from</span> <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> to <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        super<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç¡¬ç¼–ç æ ¸å¿ƒåœ°å€å…è´¹ï¼ˆæ›¿ä»£ç™½åå•ï¼‰</span>
    <span class="token builtin">bool</span> isCoreAddress <span class="token operator">=</span>
        <span class="token keyword keyword-from">from</span> <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token keyword keyword-from">from</span> <span class="token operator">==</span> STAKING_CONTRACT <span class="token operator">||</span>
        <span class="token keyword keyword-from">from</span> <span class="token operator">==</span> MARKETING_ADDRESS <span class="token operator">||</span>
        <span class="token keyword keyword-from">from</span> <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span>uniswapV2Router<span class="token punctuation">)</span> <span class="token operator">||</span>
        to <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        to <span class="token operator">==</span> STAKING_CONTRACT <span class="token operator">||</span>
        to <span class="token operator">==</span> MARKETING_ADDRESS <span class="token operator">||</span>
        to <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span>uniswapV2Router<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>isCoreAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        super<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span><span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ™®é€šç”¨æˆ·æ­£å¸¸æ”¶è´¹</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>æ­¥éª¤3ï¼šç§»é™¤å»¶è¿Ÿä¹°å…¥ç™½åå•</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token keyword keyword-modifier">modifier</span> <span class="token function">delayedBuyCheck</span><span class="token punctuation">(</span><span class="token builtin">address</span> buyer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>delayedBuyEnabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// ç§»é™¤ç™½åå•åˆ¤æ–­</span>
        <span class="token builtin">uint256</span> requiredDelay <span class="token operator">=</span> <span class="token function">getDelayedBuyPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...å¦‚æœéœ€è¦å»¶è¿Ÿä¹°å…¥ï¼Œæ‰€æœ‰ç”¨æˆ·ç»Ÿä¸€ç­‰å¾…</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-_">_</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æˆ–è€…ç›´æ¥ç§»é™¤å»¶è¿Ÿä¹°å…¥æœºåˆ¶</span>
</code></pre><p><strong>æ­¥éª¤4ï¼šç§»é™¤é»‘åå•</strong></p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// åˆ é™¤</span>
<span class="token comment">// mapping(address =&gt; bool) public blacklisted;</span>
<span class="token comment">// modifier notBlacklisted(address account) { ... }</span>

<span class="token comment">// ä¹°å…¥/å–å‡ºå‡½æ•°ç§»é™¤ä¿®é¥°å™¨</span>
<span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint256</span> amount<span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç§»é™¤ notBlacklisted(to)</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">_handleSell</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword keyword-from">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint256</span> amount<span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç§»é™¤ notBlacklisted(from)</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="-ä¼˜ç‚¹">âœ… ä¼˜ç‚¹ </h4>
<ul>
<li>ç¬¦åˆOKäº¤æ˜“æ‰€å®¡è®¡è¦æ±‚ï¼ˆæ— åŠ¨æ€é»‘ç™½åå•ï¼‰</li>
<li>æ ¸å¿ƒåœ°å€è´¹ç”¨é€»è¾‘ä¿æŒå®Œæ•´</li>
<li>ä»£ç ç®€æ´é€æ˜</li>
<li>Gas æˆæœ¬æ›´ä½ï¼ˆæ— éœ€æŸ¥mappingï¼‰</li>
</ul>
<h4 id="-ç¼ºç‚¹">âŒ ç¼ºç‚¹ </h4>
<ul>
<li>æ— æ³•åŠ¨æ€è°ƒæ•´æ ¸å¿ƒåœ°å€ï¼ˆéœ€è¦é‡æ–°éƒ¨ç½²ï¼‰</li>
<li>æ— æ³•åº”å¯¹ç´§æ€¥æƒ…å†µï¼ˆå¦‚é»‘å®¢æ”»å‡»ï¼‰</li>
</ul>
<hr>
<h3 id="62-æ–¹æ¡ˆbå»¶è¿Ÿä¹°å…¥æœŸæ”¹ä¸ºé¢„å”®æœŸæ¨è">6.2 æ–¹æ¡ˆBï¼šå»¶è¿Ÿä¹°å…¥æœŸæ”¹ä¸º"é¢„å”®æœŸ"ï¼ˆæ¨èï¼‰ </h3>
<p>å½“å‰çš„å»¶è¿Ÿä¹°å…¥æœºåˆ¶å¯¹æ‰€æœ‰äººéƒ½æ˜¯è´Ÿæ‹…ï¼Œå»ºè®®æ”¹ä¸ºï¼š</p>
<pre data-role="codeBlock" data-info="solidity" class="language-solidity solidity"><code><span class="token comment">// åˆ é™¤ delayedBuyEnabled å’Œç™½åå•ç›¸å…³</span>
<span class="token comment">// æ”¹ä¸ºé¢„å”®æœŸæœºåˆ¶</span>

<span class="token builtin">uint256</span> <span class="token keyword keyword-public">public</span> presaleEndTime<span class="token punctuation">;</span>

<span class="token keyword keyword-function">function</span> <span class="token function">_handleBuy</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword keyword-private">private</span> <span class="token punctuation">{</span>
    <span class="token comment">// é¢„å”®æœŸæ£€æŸ¥</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>presaleActive <span class="token operator">&amp;&amp;</span> block<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> presaleEndTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-revert">revert</span><span class="token punctuation">(</span><span class="token string">"Presale not ended"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...æ­£å¸¸ä¹°å…¥</span>
<span class="token punctuation">}</span>

<span class="token comment">// Ownerè®¾ç½®é¢„å”®ç»“æŸ</span>
<span class="token keyword keyword-function">function</span> <span class="token function">endPresale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-external">external</span> onlyOwner <span class="token punctuation">{</span>
    presaleActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="-ä¼˜ç‚¹-1">âœ… ä¼˜ç‚¹ </h4>
<ul>
<li>é€»è¾‘æ›´æ¸…æ™°ï¼šé¢„å”®æœŸ vs å…¬å¼€äº¤æ˜“æœŸ</li>
<li>æ— éœ€ç™½åå•ç»•è¿‡</li>
<li>ç¬¦åˆå¸¸è§ä»£å¸å‘è¡Œæ¨¡å¼</li>
</ul>
<hr>
<h3 id="63-æ–¹æ¡ˆcä¿ç•™stakingçš„eoaæ£€æŸ¥">6.3 æ–¹æ¡ˆCï¼šä¿ç•™Stakingçš„EOAæ£€æŸ¥ </h3>
<p><strong>å»ºè®®ï¼šä¿ç•™</strong></p>
<p>ç†ç”±ï¼š</p>
<ol>
<li>EOAæ£€æŸ¥ä¸å±äº"é»‘ç™½åå•"ï¼Œæ˜¯å®‰å…¨æªæ–½</li>
<li>ä¸å½±å“OKäº¤æ˜“æ‰€å®¡è®¡ï¼ˆä»…é™Stakingåˆçº¦å†…éƒ¨ï¼‰</li>
<li>å¯é€šè¿‡é…ç½®å…³é—­ï¼š<code>shouldCheckEOA() return false</code></li>
</ol>
<hr>
<h2 id="ä¸ƒ-æ€»ç»“ä¸å»ºè®®">ä¸ƒã€æ€»ç»“ä¸å»ºè®® </h2>
<h3 id="71-å½“å‰é»‘ç™½åå•ä½¿ç”¨æƒ…å†µ">7.1 å½“å‰é»‘ç™½åå•ä½¿ç”¨æƒ…å†µ </h3>
<table>
<thead>
<tr>
<th>æœºåˆ¶</th>
<th>ä½ç½®</th>
<th>å¿…è¦æ€§</th>
<th>æ˜¯å¦å½±å“å®¡è®¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>è´¹ç”¨ç™½åå•</td>
<td>SYIåˆçº¦</td>
<td>ğŸ”´ å¿…éœ€</td>
<td>âš ï¸ ä¼šå½±å“</td>
</tr>
<tr>
<td>äº¤æ˜“é»‘åå•</td>
<td>SYIåˆçº¦</td>
<td>ğŸŸ¢ éå¿…éœ€</td>
<td>âš ï¸ ä¼šå½±å“</td>
</tr>
<tr>
<td><strong>ğŸ”¥ é¢„å”®æœŸç™½åå•</strong></td>
<td><strong>SYIåˆçº¦</strong></td>
<td><strong>ğŸŸ¢ éå¿…éœ€</strong></td>
<td><strong>ğŸ”´ ä¸¥é‡å½±å“</strong></td>
</tr>
<tr>
<td>EOAæ£€æŸ¥</td>
<td>Stakingåˆçº¦</td>
<td>ğŸŸ¡ å»ºè®®ä¿ç•™</td>
<td>âœ… ä¸å½±å“</td>
</tr>
</tbody>
</table>
<h3 id="72-åˆ†æ­¥å®æ–½å»ºè®®">7.2 åˆ†æ­¥å®æ–½å»ºè®® </h3>
<h4 id="é˜¶æ®µ1ç«‹å³ç§»é™¤ä½é£é™©">é˜¶æ®µ1ï¼šç«‹å³ç§»é™¤ï¼ˆä½é£é™©ï¼‰ </h4>
<ul>
<li>âœ… <strong>ğŸ”¥ ç§»é™¤é¢„å”®æœŸç™½åå•æœºåˆ¶ï¼ˆæœ€ä¼˜å…ˆï¼‰</strong>
<ul>
<li>åˆ é™¤é¢„å”®æœŸæ£€æŸ¥ï¼š<code>SYIBase.sol:822-827</code></li>
<li>åˆ é™¤é¢„å”®æœŸçŠ¶æ€å˜é‡ï¼š<code>presaleStartTime, presaleDuration, presaleActive</code></li>
<li>åˆ é™¤é¢„å”®æœŸç®¡ç†å‡½æ•°ï¼š<code>setPresaleActive()</code></li>
<li>åˆ é™¤é¢„å”®æœŸæŸ¥è¯¢å‡½æ•°ï¼š<code>getPresaleStatus()</code></li>
</ul>
</li>
<li>âœ… ç§»é™¤äº¤æ˜“é»‘åå•ï¼ˆblacklistedï¼‰</li>
<li>âœ… ç§»é™¤é»‘åå•ç®¡ç†å‡½æ•°
<ul>
<li><code>setBlacklisted()</code></li>
<li><code>setBatchBlacklisted()</code></li>
</ul>
</li>
</ul>
<h4 id="é˜¶æ®µ2é‡æ„è´¹ç”¨é€»è¾‘ä¸­é£é™©">é˜¶æ®µ2ï¼šé‡æ„è´¹ç”¨é€»è¾‘ï¼ˆä¸­é£é™©ï¼‰ </h4>
<ul>
<li>âœ… ç”¨ç¡¬ç¼–ç åœ°å€æ›¿ä»£è´¹ç”¨ç™½åå•</li>
<li>âœ… ç§»é™¤ç™½åå•ç®¡ç†å‡½æ•°
<ul>
<li><code>initializeWhitelist()</code></li>
<li><code>setFeeWhitelisted()</code></li>
<li><code>setBatchFeeWhitelisted()</code></li>
</ul>
</li>
<li>âš ï¸ <strong>å…¨é¢æµ‹è¯•</strong>è´¹ç”¨åˆ†å‘é€»è¾‘</li>
</ul>
<h4 id="é˜¶æ®µ3ä¼˜åŒ–å»¶è¿Ÿä¹°å…¥ä½é£é™©">é˜¶æ®µ3ï¼šä¼˜åŒ–å»¶è¿Ÿä¹°å…¥ï¼ˆä½é£é™©ï¼‰ </h4>
<ul>
<li>âœ… æ”¹ä¸ºé¢„å”®æœŸæœºåˆ¶</li>
<li>âœ… ç§»é™¤å»¶è¿Ÿä¹°å…¥ç™½åå•é€»è¾‘</li>
</ul>
<h4 id="é˜¶æ®µ4å¯é€‰ä¼˜åŒ–ä½é£é™©">é˜¶æ®µ4ï¼šå¯é€‰ä¼˜åŒ–ï¼ˆä½é£é™©ï¼‰ </h4>
<ul>
<li>ğŸ”² ä¿ç•™Stakingçš„EOAæ£€æŸ¥ï¼ˆå»ºè®®ï¼‰</li>
<li>ğŸ”² æˆ–è€…é…ç½® <code>shouldCheckEOA() return false</code></li>
</ul>
<h3 id="73-æµ‹è¯•æ£€æŸ¥æ¸…å•">7.3 æµ‹è¯•æ£€æŸ¥æ¸…å• </h3>
<p>é‡æ„åå¿…é¡»æµ‹è¯•çš„åœºæ™¯ï¼š</p>
<h4 id="åŸºç¡€åŠŸèƒ½æµ‹è¯•">åŸºç¡€åŠŸèƒ½æµ‹è¯• </h4>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> ç”¨æˆ·ä¹°å…¥ä»£å¸ï¼ˆæ”¶å–1% burnè´¹ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> ç”¨æˆ·å–å‡ºä»£å¸ï¼ˆæ”¶å–1.5% marketingè´¹ + ç›ˆåˆ©ç¨ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> Stakingåˆçº¦è´¨æŠ¼ï¼ˆå…è´¹è½¬è´¦ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> Stakingåˆçº¦å–æ¬¾ï¼ˆå…è´¹è½¬è´¦ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> è´¹ç”¨è‡ªåŠ¨å¤„ç†ï¼ˆ<code>_processFeeDistribution</code>ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> æµåŠ¨æ€§æ·»åŠ ï¼ˆRouteræ“ä½œå…è´¹ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> è¥é”€åœ°å€æ”¶æ¬¾ï¼ˆå…è´¹ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> å›æ”¶æœºåˆ¶ï¼ˆ<code>recycle</code>ï¼‰</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> FundRelayåˆ†å‘</li>
</ul>
<h4 id="-é¢„å”®æœŸç›¸å…³æµ‹è¯•ç§»é™¤åéªŒè¯">ğŸ”¥ é¢„å”®æœŸç›¸å…³æµ‹è¯•ï¼ˆç§»é™¤åéªŒè¯ï¼‰ </h4>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤é¢„å”®æœŸæ£€æŸ¥å·²åˆ é™¤</strong>ï¼šæ‰€æœ‰ç”¨æˆ·å¯ç«‹å³ä¹°å…¥</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤ç™½åå•ä¸å†ç»•è¿‡æ£€æŸ¥</strong>ï¼šæ ¸å¿ƒåœ°å€ä»ç„¶å…è´¹ï¼Œä½†æ— é¢„å”®ç‰¹æƒ</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤é¢„å”®æœŸç®¡ç†å‡½æ•°å·²åˆ é™¤</strong>ï¼š<code>setPresaleActive()</code> ä¸å­˜åœ¨</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤é¢„å”®æœŸæŸ¥è¯¢å‡½æ•°å·²åˆ é™¤</strong>ï¼š<code>getPresaleStatus()</code> ä¸å­˜åœ¨</li>
</ul>
<h4 id="é»‘åå•ç§»é™¤éªŒè¯">é»‘åå•ç§»é™¤éªŒè¯ </h4>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤é»‘åå•æ£€æŸ¥å·²åˆ é™¤</strong>ï¼šä»»ä½•åœ°å€éƒ½å¯ä»¥ä¹°å–</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> <strong>ç¡®è®¤é»‘åå•ç®¡ç†å‡½æ•°å·²åˆ é™¤</strong>ï¼š<code>setBlacklisted()</code> ä¸å­˜åœ¨</li>
</ul>
<h3 id="74-é£é™©æç¤º">7.4 é£é™©æç¤º </h3>
<p>âš ï¸ <strong>å…³é”®é£é™©</strong>ï¼š</p>
<ol>
<li><strong>ğŸ”¥ é¢„å”®æœŸç™½åå•æ˜¯æœ€ä¸¥é‡çš„å®¡è®¡é—®é¢˜</strong>ï¼šä¼šè¢«OKäº¤æ˜“æ‰€ç›´æ¥æ ‡è®°ä¸ºè¯ˆéª—é¡¹ç›®</li>
<li>è´¹ç”¨é€»è¾‘é‡æ„å¯èƒ½å¯¼è‡´<strong>ç»æµæ¨¡å‹å´©æºƒ</strong></li>
<li>å¿…é¡»ä¿è¯æ ¸å¿ƒåœ°å€ï¼ˆStakingã€Marketingã€Routerï¼‰çš„å…è´¹è½¬è´¦</li>
<li>å»ºè®®å…ˆåœ¨æµ‹è¯•ç½‘å……åˆ†æµ‹è¯•ï¼Œå†éƒ¨ç½²ä¸»ç½‘</li>
</ol>
<p>ğŸš¨ <strong>ç‰¹åˆ«è­¦å‘Š</strong>ï¼š</p>
<ul>
<li><strong>é¢„å”®æœŸç™½åå•ï¼ˆpresaleActiveï¼‰</strong> æ˜¯éšè—çš„ç™½åå•æœºåˆ¶ï¼Œ<strong>å¿…é¡»ç«‹å³ç§»é™¤</strong></li>
<li>è¯¥æœºåˆ¶é€šè¿‡ <code>feeWhitelisted</code> ç»•è¿‡é¢„å”®æœŸæ£€æŸ¥ï¼Œå®ç°äº†"ç™½åå•ä¸“å±é¢„å”®"</li>
<li>è¿™ä¸OKäº¤æ˜“æ‰€çš„å®¡è®¡è¦æ±‚<strong>ä¸¥é‡å†²çª</strong>ï¼Œæ˜¯æœ€é«˜ä¼˜å…ˆçº§éœ€è¦ç§»é™¤çš„åŠŸèƒ½</li>
</ul>
<p>ğŸ“‹ <strong>å®¡è®¡å»ºè®®</strong>ï¼š</p>
<ul>
<li>é‡æ„åè¯·ç¬¬ä¸‰æ–¹å®¡è®¡å…¬å¸é‡æ–°å®¡è®¡</li>
<li>æä¾›è¯¦ç»†çš„è´¹ç”¨æµè½¬æ–‡æ¡£ç»™OKäº¤æ˜“æ‰€</li>
<li>è¯´æ˜ç¡¬ç¼–ç åœ°å€çš„å®‰å…¨æ€§ä¼˜äºåŠ¨æ€ç™½åå•</li>
</ul>
<hr>
<h2 id="å…«-é™„å½•">å…«ã€é™„å½• </h2>
<h3 id="81-ç›¸å…³åˆçº¦åœ°å€æ˜ å°„">8.1 ç›¸å…³åˆçº¦åœ°å€æ˜ å°„ </h3>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å½“å‰å˜é‡</th>
<th>å»ºè®®æ”¹ä¸ºä¸å¯å˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Staking</td>
<td><code>staking</code> (immutable)</td>
<td>âœ… å·²æ˜¯immutable</td>
</tr>
<tr>
<td>Router</td>
<td><code>uniswapV2Router</code> (immutable)</td>
<td>âœ… å·²æ˜¯immutable</td>
</tr>
<tr>
<td>USDT</td>
<td><code>USDT</code> (immutable)</td>
<td>âœ… å·²æ˜¯immutable</td>
</tr>
<tr>
<td>Marketing</td>
<td><code>marketingAddress</code> (å¯å˜)</td>
<td>âš ï¸ å»ºè®®æ”¹ä¸ºimmutable</td>
</tr>
<tr>
<td>FundRelay</td>
<td><code>fundRelay</code> (å¯å˜)</td>
<td>âš ï¸ å»ºè®®æ”¹ä¸ºimmutable</td>
</tr>
</tbody>
</table>
<h3 id="82-å‚è€ƒé“¾æ¥">8.2 å‚è€ƒé“¾æ¥ </h3>
<ul>
<li>OLAä»£å¸ï¼ˆå‚è€ƒï¼‰ï¼š<a href="https://bscscan.com/token/0xfc548e35c4a3603b09204acead0cd16908423eea">https://bscscan.com/token/0xfc548e35c4a3603b09204acead0cd16908423eea</a></li>
<li>OKäº¤æ˜“æ‰€å®‰å…¨è¦æ±‚ï¼šå¾…è¡¥å……</li>
</ul>
<hr>
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>: v1.1 ğŸ”¥ å¢åŠ é¢„å”®æœŸç™½åå•æœºåˆ¶åˆ†æ<br>
<strong>æ›´æ–°æ—¥æœŸ</strong>: 2025-10-13<br>
<strong>ä½œè€…</strong>: Claude Code Analysis</p>
<h2 id="-v11-æ›´æ–°å†…å®¹">ğŸ“Œ v1.1 æ›´æ–°å†…å®¹ </h2>
<p>æ–°å¢äº†<strong>2.4 é¢„å”®æœŸç™½åå•æœºåˆ¶</strong>ç« èŠ‚ï¼Œé‡ç‚¹è¯´æ˜ï¼š</p>
<ol>
<li><strong>éšè—çš„ç™½åå•é¢„å”®</strong>ï¼šé€šè¿‡ <code>feeWhitelisted</code> + <code>presaleActive</code> ç»„åˆå®ç°</li>
<li><strong>å·¥ä½œåŸç†</strong>ï¼šç™½åå•ç”¨æˆ·ç»•è¿‡ <code>_handleBuy()</code> ä¸­çš„é¢„å”®æœŸæ£€æŸ¥</li>
<li><strong>å®¡è®¡å†²çª</strong>ï¼šä¸OKäº¤æ˜“æ‰€å®¡è®¡è¦æ±‚<strong>ä¸¥é‡å†²çª</strong></li>
<li><strong>å½±å“åˆ†æ</strong>ï¼šé¢„å”®æœŸ30å¤©å†…ï¼Œä»…ç™½åå•å¯ä¹°å…¥ï¼Œæ™®é€šç”¨æˆ·å®Œå…¨å°é”</li>
<li><strong>ç§»é™¤æ–¹æ¡ˆ</strong>ï¼šæä¾›ä¸¤ç§æ–¹æ¡ˆï¼ˆå®Œå…¨ç§»é™¤ vs å…¨å±€é”å®šï¼‰</li>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼šæ ‡è®°ä¸º<strong>æœ€é«˜ä¼˜å…ˆçº§éœ€è¦ç§»é™¤çš„åŠŸèƒ½</strong></li>
</ol>
</div>
      </div>
      
      
    
    
    <script type="module">
// TODO: If ZenUML gets integrated into mermaid in the future,
//      we can remove the following lines.


var MERMAID_CONFIG = ({"startOnLoad":false});
if (typeof MERMAID_CONFIG !== 'undefined') {
  MERMAID_CONFIG.startOnLoad = false
  MERMAID_CONFIG.cloneCssStyles = false
  MERMAID_CONFIG.theme = "default"
}

mermaid.initialize(MERMAID_CONFIG || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidetransitionend', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
} else {
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
}
</script>
    
    
    
  
    </body></html>